<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–ë–µ–ª—ã–π –ü–∞—É—á–æ–∫</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #050508;
    --surface: #0d0d14;
    --surface2: #13131e;
    --border: rgba(255,255,255,0.06);
    --accent: #7fff6e;
    --accent2: #00d4ff;
    --warm: #ff9f43;
    --hot: #ff4757;
    --text: #e8e8f0;
    --muted: rgba(232,232,240,0.4);
    --mono: 'Space Mono', monospace;
    --sans: 'Syne', sans-serif;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  html, body {
    height: 100%;
    background: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    overflow: hidden;
  }

  /* ‚îÄ‚îÄ –°–µ—Ç–∫–∞ –ø–∞—É—Ç–∏–Ω—ã ‚îÄ‚îÄ */
  .web-bg {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    overflow: hidden;
  }
  .web-bg svg {
    width: 100%;
    height: 100%;
    opacity: 0.07;
  }

  /* ‚îÄ‚îÄ –®—É–º-—Ç–µ–∫—Å—Ç—É—Ä–∞ ‚îÄ‚îÄ */
  .noise {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    opacity: 0.03;
  }

  /* ‚îÄ‚îÄ App shell ‚îÄ‚îÄ */
  .app {
    position: relative;
    z-index: 2;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
  .header {
    padding: 20px 20px 0;
    flex-shrink: 0;
  }
  .header-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }
  .logo {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .logo-icon {
    width: 36px;
    height: 36px;
    position: relative;
  }
  .logo-icon svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 0 8px var(--accent));
  }
  .logo-text {
    font-family: var(--mono);
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 0.1em;
    color: var(--accent);
    text-transform: uppercase;
  }
  .logo-sub {
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 0.05em;
    margin-top: 1px;
  }
  .status-pill {
    display: flex;
    align-items: center;
    gap: 6px;
    background: rgba(127,255,110,0.08);
    border: 1px solid rgba(127,255,110,0.2);
    border-radius: 20px;
    padding: 5px 12px;
    font-family: var(--mono);
    font-size: 10px;
    color: var(--accent);
    letter-spacing: 0.08em;
  }
  .status-dot {
    width: 6px;
    height: 6px;
    background: var(--accent);
    border-radius: 50%;
    box-shadow: 0 0 6px var(--accent);
    animation: pulse 2s ease-in-out infinite;
  }
  @keyframes pulse {
    0%, 100% { opacity: 1; box-shadow: 0 0 6px var(--accent); }
    50% { opacity: 0.5; box-shadow: 0 0 12px var(--accent); }
  }

  /* ‚îÄ‚îÄ Stats row ‚îÄ‚îÄ */
  .stats-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-bottom: 20px;
  }
  .stat-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 14px 12px;
    position: relative;
    overflow: hidden;
    transition: border-color 0.2s;
  }
  .stat-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: var(--accent);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.6s ease;
  }
  .stat-card.loaded::before { transform: scaleX(1); }
  .stat-card:nth-child(2)::before { background: var(--accent2); }
  .stat-card:nth-child(3)::before { background: var(--warm); }

  .stat-val {
    font-family: var(--mono);
    font-size: 22px;
    font-weight: 700;
    color: var(--text);
    line-height: 1;
    margin-bottom: 4px;
  }
  .stat-label {
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 0.06em;
    text-transform: uppercase;
  }

  /* ‚îÄ‚îÄ –ù–∞–≤–∏–≥–∞—Ü–∏—è ‚îÄ‚îÄ */
  .nav {
    display: flex;
    gap: 4px;
    margin-bottom: 16px;
  }
  .nav-btn {
    flex: 1;
    background: none;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 8px 6px;
    font-family: var(--mono);
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 0.05em;
    cursor: pointer;
    transition: all 0.2s;
    text-transform: uppercase;
  }
  .nav-btn.active {
    background: var(--accent);
    border-color: var(--accent);
    color: var(--bg);
    font-weight: 700;
  }

  /* ‚îÄ‚îÄ –ö–æ–Ω—Ç–µ–Ω—Ç ‚îÄ‚îÄ */
  .content {
    flex: 1;
    overflow-y: auto;
    padding: 0 20px 100px;
    -webkit-overflow-scrolling: touch;
  }
  .content::-webkit-scrollbar { display: none; }

  /* ‚îÄ‚îÄ –°–µ–∫—Ü–∏–∏ ‚îÄ‚îÄ */
  .section { display: none; }
  .section.active { display: block; animation: fadeIn 0.3s ease; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

  /* ‚îÄ‚îÄ –õ–∏–¥-–∫–∞—Ä—Ç–æ—á–∫–∏ ‚îÄ‚îÄ */
  .leads-list { display: flex; flex-direction: column; gap: 12px; }

  .lead-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 16px;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s;
    animation: slideIn 0.4s ease both;
  }
  .lead-card:active { transform: scale(0.98); }

  @keyframes slideIn {
    from { opacity: 0; transform: translateX(-12px); }
    to { opacity: 1; transform: translateX(0); }
  }

  .lead-card::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, transparent 60%, rgba(127,255,110,0.03));
    pointer-events: none;
  }

  .lead-card-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 10px;
  }
  .lead-badge {
    display: flex;
    align-items: center;
    gap: 5px;
    font-family: var(--mono);
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.08em;
    padding: 3px 8px;
    border-radius: 6px;
  }
  .lead-badge.hot {
    background: rgba(255,71,87,0.15);
    color: var(--hot);
    border: 1px solid rgba(255,71,87,0.3);
  }
  .lead-badge.warm {
    background: rgba(0,212,255,0.1);
    color: var(--accent2);
    border: 1px solid rgba(0,212,255,0.2);
  }
  .lead-time {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--muted);
  }
  .lead-user {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 4px;
  }
  .lead-chat {
    font-size: 11px;
    color: var(--muted);
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .lead-chat::before {
    content: '#';
    color: var(--accent);
    font-family: var(--mono);
  }
  .lead-text {
    font-size: 12px;
    color: rgba(232,232,240,0.7);
    line-height: 1.5;
    border-left: 2px solid var(--border);
    padding-left: 10px;
    margin-bottom: 12px;
    font-style: italic;
  }
  .lead-score-bar {
    height: 3px;
    background: rgba(255,255,255,0.06);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 12px;
  }
  .lead-score-fill {
    height: 100%;
    border-radius: 2px;
    background: linear-gradient(90deg, var(--accent2), var(--accent));
    transition: width 1s ease;
  }
  .lead-actions {
    display: flex;
    gap: 8px;
  }
  .btn-write {
    flex: 1;
    background: var(--accent);
    color: var(--bg);
    border: none;
    border-radius: 10px;
    padding: 10px;
    font-family: var(--mono);
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 0.05em;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-write:active { transform: scale(0.97); background: #6de860; }

  .btn-skip {
    width: 40px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--muted);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    transition: all 0.2s;
  }
  .btn-skip:active { background: rgba(255,71,87,0.1); color: var(--hot); }

  /* ‚îÄ‚îÄ –ü—É—Å—Ç–æ–π —Å—Ç–µ–π—Ç ‚îÄ‚îÄ */
  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    text-align: center;
  }
  .empty-spider {
    font-size: 48px;
    margin-bottom: 16px;
    animation: float 3s ease-in-out infinite;
  }
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }
  .empty-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 8px;
  }
  .empty-sub {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.6;
  }

  /* ‚îÄ‚îÄ –°–µ–∫—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è ‚îÄ‚îÄ */
  .profile-section { display: flex; flex-direction: column; gap: 12px; }

  .profile-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 18px;
  }
  .profile-card-title {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--accent);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-bottom: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .profile-card-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }
  .profile-row {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 10px 0;
    border-bottom: 1px solid var(--border);
  }
  .profile-row:last-child { border-bottom: none; }
  .profile-row-icon {
    font-size: 16px;
    width: 24px;
    text-align: center;
    flex-shrink: 0;
    margin-top: 1px;
  }
  .profile-row-label {
    font-size: 11px;
    color: var(--muted);
    margin-bottom: 2px;
    letter-spacing: 0.04em;
  }
  .profile-row-val {
    font-size: 13px;
    color: var(--text);
    font-weight: 500;
    line-height: 1.4;
  }

  /* –¢–∞—Ä–∏—Ñ */
  .plan-card {
    background: linear-gradient(135deg, rgba(127,255,110,0.06), rgba(0,212,255,0.04));
    border: 1px solid rgba(127,255,110,0.2);
    border-radius: 16px;
    padding: 18px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .plan-name {
    font-size: 18px;
    font-weight: 800;
    color: var(--text);
    margin-bottom: 4px;
  }
  .plan-until {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--muted);
  }
  .plan-badge {
    background: var(--accent);
    color: var(--bg);
    font-family: var(--mono);
    font-size: 11px;
    font-weight: 700;
    padding: 6px 14px;
    border-radius: 8px;
    letter-spacing: 0.05em;
  }

  /* –ü—Ä–æ–≥—Ä–µ—Å—Å –ª–∏–º–∏—Ç–∞ */
  .limit-bar-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 16px;
  }
  .limit-top {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
  }
  .limit-label {
    font-size: 12px;
    color: var(--muted);
  }
  .limit-val {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--accent);
  }
  .limit-bar {
    height: 6px;
    background: rgba(255,255,255,0.06);
    border-radius: 4px;
    overflow: hidden;
  }
  .limit-fill {
    height: 100%;
    border-radius: 4px;
    background: linear-gradient(90deg, var(--accent2), var(--accent));
    transition: width 1s cubic-bezier(0.16,1,0.3,1);
  }

  /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
  .control-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
  }
  .ctrl-btn {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 16px 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
  }
  .ctrl-btn:active { transform: scale(0.97); border-color: var(--accent); }
  .ctrl-btn-icon { font-size: 22px; }
  .ctrl-btn-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text);
  }
  .ctrl-btn-sub {
    font-size: 10px;
    color: var(--muted);
    font-family: var(--mono);
  }

  /* ‚îÄ‚îÄ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚îÄ‚îÄ */
  .analytics-section { display: flex; flex-direction: column; gap: 12px; }

  .chart-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 18px;
  }
  .chart-title {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--accent);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-bottom: 16px;
  }
  .bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 6px;
    height: 80px;
  }
  .bar-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    height: 100%;
    justify-content: flex-end;
  }
  .bar {
    width: 100%;
    border-radius: 4px 4px 0 0;
    background: linear-gradient(180deg, var(--accent2), rgba(0,212,255,0.3));
    transition: height 1s cubic-bezier(0.16,1,0.3,1);
    min-height: 4px;
  }
  .bar.today { background: linear-gradient(180deg, var(--accent), rgba(127,255,110,0.3)); }
  .bar-day {
    font-family: var(--mono);
    font-size: 9px;
    color: var(--muted);
    letter-spacing: 0.04em;
  }

  .funnel-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 18px;
  }
  .funnel-row {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
  }
  .funnel-label {
    font-size: 12px;
    color: var(--muted);
    width: 80px;
    flex-shrink: 0;
  }
  .funnel-bar-wrap {
    flex: 1;
    height: 24px;
    background: rgba(255,255,255,0.04);
    border-radius: 6px;
    overflow: hidden;
  }
  .funnel-fill {
    height: 100%;
    border-radius: 6px;
    display: flex;
    align-items: center;
    padding-left: 8px;
    font-family: var(--mono);
    font-size: 10px;
    font-weight: 700;
    color: var(--bg);
    transition: width 1s cubic-bezier(0.16,1,0.3,1);
  }

  /* ‚îÄ‚îÄ Bottom nav ‚îÄ‚îÄ */
  .bottom-nav {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    z-index: 10;
    background: rgba(5,5,8,0.92);
    backdrop-filter: blur(20px);
    border-top: 1px solid var(--border);
    display: flex;
    padding: 10px 20px calc(10px + env(safe-area-inset-bottom));
    gap: 4px;
  }
  .bnav-btn {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 6px 4px;
    border-radius: 12px;
    transition: all 0.2s;
  }
  .bnav-btn.active {
    background: rgba(127,255,110,0.08);
  }
  .bnav-icon { font-size: 20px; line-height: 1; }
  .bnav-label {
    font-family: var(--mono);
    font-size: 9px;
    color: var(--muted);
    letter-spacing: 0.06em;
    text-transform: uppercase;
  }
  .bnav-btn.active .bnav-label { color: var(--accent); }

  /* ‚îÄ‚îÄ Toast ‚îÄ‚îÄ */
  .toast {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%) translateY(-80px);
    background: var(--surface2);
    border: 1px solid var(--accent);
    border-radius: 12px;
    padding: 10px 20px;
    font-family: var(--mono);
    font-size: 12px;
    color: var(--accent);
    z-index: 100;
    transition: transform 0.3s cubic-bezier(0.16,1,0.3,1);
    white-space: nowrap;
    box-shadow: 0 4px 30px rgba(127,255,110,0.15);
  }
  .toast.show { transform: translateX(-50%) translateY(0); }

  /* ‚îÄ‚îÄ –ü–∞—É—á–æ–∫ loading ‚îÄ‚îÄ */
  .spider-loader {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
  }
  .spider-spin {
    font-size: 32px;
    animation: spin 2s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* Notification badge */
  .badge {
    position: absolute;
    top: -2px; right: -2px;
    background: var(--hot);
    color: white;
    font-family: var(--mono);
    font-size: 9px;
    font-weight: 700;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .bnav-btn { position: relative; }

  /* –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ */
  .calibration-banner {
    background: linear-gradient(135deg, rgba(255,159,67,0.1), rgba(255,71,87,0.05));
    border: 1px solid rgba(255,159,67,0.3);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
    display: none;
  }
  .calibration-banner.show { display: block; animation: fadeIn 0.4s ease; }
  .cal-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--warm);
    margin-bottom: 6px;
  }
  .cal-sub {
    font-size: 12px;
    color: var(--muted);
    margin-bottom: 12px;
    line-height: 1.5;
  }
  .cal-btns {
    display: flex;
    gap: 8px;
  }
  .cal-btn {
    flex: 1;
    padding: 9px;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--surface2);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .cal-btn.good {
    color: var(--accent);
    border-color: rgba(127,255,110,0.3);
  }
  .cal-btn.bad {
    color: var(--hot);
    border-color: rgba(255,71,87,0.3);
  }
  .cal-btn:active { transform: scale(0.97); }
</style>
</head>
<body>

<!-- –ü–∞—É—Ç–∏–Ω–∞ —Ñ–æ–Ω -->
<div class="web-bg">
  <svg viewBox="0 0 400 800" preserveAspectRatio="xMidYMid slice">
    <defs>
      <radialGradient id="rg" cx="50%" cy="20%">
        <stop offset="0%" stop-color="#7fff6e" stop-opacity="0.15"/>
        <stop offset="100%" stop-color="#7fff6e" stop-opacity="0"/>
      </radialGradient>
    </defs>
    <!-- –ü–∞—É—Ç–∏–Ω–∞: –ª–∏–Ω–∏–∏ –∏–∑ —Ü–µ–Ω—Ç—Ä–∞ -->
    <g stroke="white" stroke-width="0.5" opacity="0.6">
      <line x1="200" y1="150" x2="200" y2="0"/>
      <line x1="200" y1="150" x2="350" y2="50"/>
      <line x1="200" y1="150" x2="400" y2="200"/>
      <line x1="200" y1="150" x2="320" y2="350"/>
      <line x1="200" y1="150" x2="200" y2="380"/>
      <line x1="200" y1="150" x2="80" y2="350"/>
      <line x1="200" y1="150" x2="0" y2="200"/>
      <line x1="200" y1="150" x2="50" y2="50"/>
    </g>
    <!-- –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—á–µ—Å–∫–∏–µ –¥—É–≥–∏ -->
    <g stroke="white" stroke-width="0.4" fill="none" opacity="0.4">
      <path d="M200,40 Q310,90 350,150 Q310,210 200,250 Q90,210 50,150 Q90,90 200,40"/>
      <path d="M200,10 Q360,80 390,190 Q340,280 200,320 Q60,280 10,190 Q40,80 200,10"/>
    </g>
    <circle cx="200" cy="150" r="300" fill="url(#rg)" opacity="0.5"/>
  </svg>
</div>
<div class="noise"></div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<div class="app">
  <!-- Header -->
  <div class="header">
    <div class="header-top">
      <div class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 36 36" fill="none">
            <!-- –ü–∞—É—á–æ–∫ SVG -->
            <circle cx="18" cy="16" r="7" fill="#7fff6e" opacity="0.9"/>
            <circle cx="18" cy="16" r="4" fill="#050508"/>
            <circle cx="18" cy="16" r="1.5" fill="#7fff6e"/>
            <!-- –õ–∞–ø–∫–∏ -->
            <line x1="11" y1="12" x2="3" y2="7" stroke="#7fff6e" stroke-width="1.2" stroke-linecap="round"/>
            <line x1="11" y1="16" x2="2" y2="16" stroke="#7fff6e" stroke-width="1.2" stroke-linecap="round"/>
            <line x1="11" y1="20" x2="3" y2="25" stroke="#7fff6e" stroke-width="1.2" stroke-linecap="round"/>
            <line x1="25" y1="12" x2="33" y2="7" stroke="#7fff6e" stroke-width="1.2" stroke-linecap="round"/>
            <line x1="25" y1="16" x2="34" y2="16" stroke="#7fff6e" stroke-width="1.2" stroke-linecap="round"/>
            <line x1="25" y1="20" x2="33" y2="25" stroke="#7fff6e" stroke-width="1.2" stroke-linecap="round"/>
            <!-- –ü–∞—É—Ç–∏–Ω–∫–∞ –≤–≤–µ—Ä—Ö -->
            <line x1="18" y1="9" x2="18" y2="2" stroke="#7fff6e" stroke-width="0.8" opacity="0.5"/>
          </svg>
        </div>
        <div>
          <div class="logo-text">–ë–µ–ª—ã–π –ø–∞—É—á–æ–∫</div>
          <div class="logo-sub">Lead Hunter v2.0</div>
        </div>
      </div>
      <div class="status-pill">
        <div class="status-dot"></div>
        ACTIVE
      </div>
    </div>

    <!-- –°—Ç–∞—Ç—ã -->
    <div class="stats-row">
      <div class="stat-card" id="sc1">
        <div class="stat-val" id="stat-today">0</div>
        <div class="stat-label">–°–µ–≥–æ–¥–Ω—è</div>
      </div>
      <div class="stat-card" id="sc2">
        <div class="stat-val" id="stat-total">0</div>
        <div class="stat-label">–í—Å–µ–≥–æ –ª–∏–¥–æ–≤</div>
      </div>
      <div class="stat-card" id="sc3">
        <div class="stat-val" id="stat-days">0</div>
        <div class="stat-label">–î–Ω–µ–π –∞–∫—Ç–∏–≤–µ–Ω</div>
      </div>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="nav">
      <button class="nav-btn active" onclick="switchTab('leads',this)">–õ–∏–¥—ã</button>
      <button class="nav-btn" onclick="switchTab('profile',this)">–ü—Ä–æ—Ñ–∏–ª—å</button>
      <button class="nav-btn" onclick="switchTab('analytics',this)">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
    </div>
  </div>

  <!-- Content -->
  <div class="content">

    <!-- –õ–∏–¥—ã -->
    <div class="section active" id="sec-leads">

      <!-- –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ -->
      <div class="calibration-banner" id="cal-banner">
        <div class="cal-title">üéØ –ö–∞–∫ –ª–∏–¥—ã?</div>
        <div class="cal-sub">–°–∫–∞–∂–∏ —á–µ—Å—Ç–Ω–æ ‚Äî —è –ø–æ–¥—Å—Ç—Ä–æ—é –ø–æ–∏—Å–∫ —Ç–æ—á–Ω–µ–µ –ø–æ–¥ —Ç–µ–±—è</div>
        <div class="cal-btns">
          <button class="cal-btn good" onclick="calibrate('good')">üëç –û–≥–æ–Ω—å</button>
          <button class="cal-btn bad" onclick="calibrate('bad')">üëé –ù–µ —Ç–æ</button>
        </div>
      </div>

      <div class="leads-list" id="leads-list">
        <div class="spider-loader"><div class="spider-spin">üï∑</div></div>
      </div>
    </div>

    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div class="section" id="sec-profile">
      <div class="profile-section">

        <!-- –¢–∞—Ä–∏—Ñ -->
        <div class="plan-card">
          <div>
            <div class="plan-name" id="plan-name">–°—Ç–∞—Ä—Ç ‚ö°</div>
            <div class="plan-until" id="plan-until">–¥–æ 15.03.2026</div>
          </div>
          <div class="plan-badge" id="plan-badge">–°–¢–ê–†–¢</div>
        </div>

        <!-- –õ–∏–º–∏—Ç –ª–∏–¥–æ–≤ -->
        <div class="limit-bar-wrap">
          <div class="limit-top">
            <div class="limit-label">–õ–∏–¥–æ–≤ —Å–µ–≥–æ–¥–Ω—è</div>
            <div class="limit-val" id="limit-text">3 / 5</div>
          </div>
          <div class="limit-bar">
            <div class="limit-fill" id="limit-fill" style="width:0%"></div>
          </div>
        </div>

        <!-- –ò–Ω—Ñ–æ –æ –Ω–∏—à–µ -->
        <div class="profile-card">
          <div class="profile-card-title">–¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</div>
          <div class="profile-row">
            <div class="profile-row-icon">üíº</div>
            <div>
              <div class="profile-row-label">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</div>
              <div class="profile-row-val" id="prof-profession">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
          </div>
          <div class="profile-row">
            <div class="profile-row-icon">üéØ</div>
            <div>
              <div class="profile-row-label">–¢–≤–æ–π –∫–ª–∏–µ–Ω—Ç</div>
              <div class="profile-row-val" id="prof-target">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
          </div>
          <div class="profile-row">
            <div class="profile-row-icon">üí∞</div>
            <div>
              <div class="profile-row-label">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
              <div class="profile-row-val" id="prof-check">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
          </div>
          <div class="profile-row">
            <div class="profile-row-icon">üîç</div>
            <div>
              <div class="profile-row-label">–ú–æ–Ω–∏—Ç–æ—Ä—é —á–∞—Ç–æ–≤</div>
              <div class="profile-row-val">100+ Telegram-—á–∞—Ç–æ–≤</div>
            </div>
          </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
        <div class="control-grid">
          <button class="ctrl-btn" onclick="togglePause()" id="pause-btn">
            <div class="ctrl-btn-icon">‚è∏</div>
            <div class="ctrl-btn-label">–ü–∞—É–∑–∞</div>
            <div class="ctrl-btn-sub">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫</div>
          </button>
          <button class="ctrl-btn" onclick="renewPlan()">
            <div class="ctrl-btn-icon">üöÄ</div>
            <div class="ctrl-btn-label">–ü—Ä–æ–¥–ª–∏—Ç—å</div>
            <div class="ctrl-btn-sub">Telegram Stars</div>
          </button>
          <button class="ctrl-btn" onclick="openSupport()">
            <div class="ctrl-btn-icon">üí¨</div>
            <div class="ctrl-btn-label">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
            <div class="ctrl-btn-sub">–ù–∞–ø–∏—Å–∞—Ç—å –Ω–∞–º</div>
          </button>
          <button class="ctrl-btn" onclick="upgradeAccount()">
            <div class="ctrl-btn-icon">‚ö°</div>
            <div class="ctrl-btn-label">–ê–ø–≥—Ä–µ–π–¥</div>
            <div class="ctrl-btn-sub">–î–æ –ü—Ä–æ</div>
          </button>
        </div>

      </div>
    </div>

    <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
    <div class="section" id="sec-analytics">
      <div class="analytics-section">

        <!-- –ì—Ä–∞—Ñ–∏–∫ –ø–æ –¥–Ω—è–º -->
        <div class="chart-card">
          <div class="chart-title">–õ–∏–¥—ã –∑–∞ 7 –¥–Ω–µ–π</div>
          <div class="bar-chart" id="bar-chart"></div>
        </div>

        <!-- –í–æ—Ä–æ–Ω–∫–∞ -->
        <div class="funnel-card">
          <div class="chart-title">–ö–æ–Ω–≤–µ—Ä—Å–∏—è</div>
          <div class="funnel-row">
            <div class="funnel-label">–ù–∞–π–¥–µ–Ω–æ</div>
            <div class="funnel-bar-wrap">
              <div class="funnel-fill" style="width:100%; background: linear-gradient(90deg,#7fff6e,#6de860);" id="f1">47</div>
            </div>
          </div>
          <div class="funnel-row">
            <div class="funnel-label">HOT –ª–∏–¥—ã</div>
            <div class="funnel-bar-wrap">
              <div class="funnel-fill" style="width:0%; background: linear-gradient(90deg,#00d4ff,#0099cc);" id="f2">18</div>
            </div>
          </div>
          <div class="funnel-row">
            <div class="funnel-label">–û—Ç–≤–µ—Ç–∏–ª–∏</div>
            <div class="funnel-bar-wrap">
              <div class="funnel-fill" style="width:0%; background: linear-gradient(90deg,#ff9f43,#e67e22);" id="f3">9</div>
            </div>
          </div>
          <div class="funnel-row">
            <div class="funnel-label">–°–æ–∑–≤–æ–Ω</div>
            <div class="funnel-bar-wrap">
              <div class="funnel-fill" style="width:0%; background: linear-gradient(90deg,#ff4757,#c0392b);" id="f4">3</div>
            </div>
          </div>
        </div>

        <!-- –¢–æ–ø —á–∞—Ç—ã -->
        <div class="profile-card">
          <div class="profile-card-title">–¢–æ–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∏</div>
          <div id="top-chats"></div>
        </div>

      </div>
    </div>

  </div><!-- /content -->
</div><!-- /app -->

<!-- Bottom nav -->
<div class="bottom-nav">
  <button class="bnav-btn active" onclick="switchSection('leads', this)">
    <span class="badge" id="new-badge" style="display:none">3</span>
    <div class="bnav-icon">üï∏</div>
    <div class="bnav-label">–õ–∏–¥—ã</div>
  </button>
  <button class="bnav-btn" onclick="switchSection('profile', this)">
    <div class="bnav-icon">üë§</div>
    <div class="bnav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
  </button>
  <button class="bnav-btn" onclick="switchSection('analytics', this)">
    <div class="bnav-icon">üìä</div>
    <div class="bnav-label">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
  </button>
</div>

<script>
// ‚îÄ‚îÄ Telegram WebApp init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const tg = window.Telegram?.WebApp;
if (tg) {
  tg.ready();
  tg.expand();
  tg.setHeaderColor('#050508');
  tg.setBackgroundColor('#050508');
}

// ‚îÄ‚îÄ Mock –¥–∞–Ω–Ω—ã–µ (–∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π API) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const DATA = {
  stats: { today: 3, total: 47, days: 12 },
  plan: { name: '–°—Ç–∞—Ä—Ç', badge: '–°–¢–ê–†–¢', until: '15.03.2026', daily: 5 },
  profile: {
    profession: '–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ Tilda –∏ Webflow',
    target: '–ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å ‚Äî —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, —Å–∞–ª–æ–Ω—ã –∫—Ä–∞—Å–æ—Ç—ã, —Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏–∏',
    check: '30 000 ‚Äî 80 000 ‚ÇΩ'
  },
  leads: [
    {
      id: 1, hot: true, user: '@mikhail_dev', userId: 123456,
      chat: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ', score: 0.91,
      text: '–°—Ä–æ—á–Ω–æ –Ω—É–∂–µ–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ª–µ–Ω–¥–∏–Ω–≥–∞ –ø–æ–¥ –∞–∫—Ü–∏—é. –ë—é–¥–∂–µ—Ç –µ—Å—Ç—å, –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ.',
      time: '14:32'
    },
    {
      id: 2, hot: true, user: '@salon_spb', userId: 234567,
      chat: '–ë–∏–∑–Ω–µ—Å –ü–µ—Ç–µ—Ä–±—É—Ä–≥', score: 0.84,
      text: '–ò—â–µ–º –∫—Ç–æ —Å–¥–µ–ª–∞–µ—Ç —Å–∞–π—Ç –¥–ª—è —Å–∞–ª–æ–Ω–∞ –∫—Ä–∞—Å–æ—Ç—ã, –Ω—É–∂–Ω–∞ –æ–Ω–ª–∞–π–Ω-–∑–∞–ø–∏—Å—å. –ö—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–∞ Tilda?',
      time: '13:15'
    },
    {
      id: 3, hot: false, user: '@resto_msk', userId: 345678,
      chat: '–†–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã–π –±–∏–∑–Ω–µ—Å –†–§', score: 0.67,
      text: '–ù—É–∂–µ–Ω –ª–µ–Ω–¥–∏–Ω–≥ –¥–ª—è –Ω–∞—à–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞, —Ö–æ—Ç–∏–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–∫–∞–∑—ã –æ–Ω–ª–∞–π–Ω.',
      time: '11:48'
    },
    {
      id: 4, hot: false, user: '@med_clinic', userId: 456789,
      chat: '–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –±–∏–∑–Ω–µ—Å', score: 0.71,
      text: '–ö—Ç–æ-–Ω–∏–±—É–¥—å –¥–µ–ª–∞–µ—Ç —Å–∞–π—Ç—ã –¥–ª—è —á–∞—Å—Ç–Ω—ã—Ö –∫–ª–∏–Ω–∏–∫? –ù—É–∂–Ω–∞ –∑–∞–ø–∏—Å—å –∫ –≤—Ä–∞—á—É –æ–Ω–ª–∞–π–Ω.',
      time: '10:20'
    },
  ],
  chart: [2, 5, 3, 7, 4, 8, 3],
  chats: [
    { name: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ', count: 12 },
    { name: '–ë–∏–∑–Ω–µ—Å –ü–µ—Ç–µ—Ä–±—É—Ä–≥', count: 8 },
    { name: '–†–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã–π –±–∏–∑–Ω–µ—Å –†–§', count: 6 },
    { name: '–ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å –†–æ—Å—Å–∏–∏', count: 5 },
  ],
  funnel: [47, 18, 9, 3],
};

// ‚îÄ‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function loadData() {
  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  animateNumber('stat-today', DATA.stats.today);
  animateNumber('stat-total', DATA.stats.total);
  animateNumber('stat-days', DATA.stats.days);

  // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ stat-card
  setTimeout(() => {
    document.querySelectorAll('.stat-card').forEach(c => c.classList.add('loaded'));
  }, 300);

  // –ü—Ä–æ—Ñ–∏–ª—å
  document.getElementById('plan-name').textContent = DATA.plan.name + ' ‚ö°';
  document.getElementById('plan-until').textContent = '–¥–æ ' + DATA.plan.until;
  document.getElementById('plan-badge').textContent = DATA.plan.badge;
  document.getElementById('prof-profession').textContent = DATA.profile.profession;
  document.getElementById('prof-target').textContent = DATA.profile.target;
  document.getElementById('prof-check').textContent = DATA.profile.check;

  // –õ–∏–º–∏—Ç
  const pct = (DATA.stats.today / DATA.plan.daily * 100).toFixed(0);
  document.getElementById('limit-text').textContent = `${DATA.stats.today} / ${DATA.plan.daily}`;
  setTimeout(() => {
    document.getElementById('limit-fill').style.width = pct + '%';
  }, 500);

  // –õ–∏–¥—ã
  renderLeads();

  // –ì—Ä–∞—Ñ–∏–∫
  renderChart();

  // –í–æ—Ä–æ–Ω–∫–∞ (–∞–Ω–∏–º–∞—Ü–∏—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π)
  const funnelPcts = DATA.funnel.map(v => (v / DATA.funnel[0] * 100).toFixed(0) + '%');
  setTimeout(() => {
    document.getElementById('f1').style.width = funnelPcts[0];
    document.getElementById('f1').textContent = DATA.funnel[0];
  }, 400);
  setTimeout(() => {
    document.getElementById('f2').style.width = funnelPcts[1];
    document.getElementById('f2').textContent = DATA.funnel[1];
  }, 600);
  setTimeout(() => {
    document.getElementById('f3').style.width = funnelPcts[2];
    document.getElementById('f3').textContent = DATA.funnel[2];
  }, 800);
  setTimeout(() => {
    document.getElementById('f4').style.width = funnelPcts[3];
    document.getElementById('f4').textContent = DATA.funnel[3];
  }, 1000);

  // –¢–æ–ø —á–∞—Ç—ã
  const chatsEl = document.getElementById('top-chats');
  chatsEl.innerHTML = DATA.chats.map((c, i) => `
    <div class="profile-row">
      <div class="profile-row-icon">${['ü•á','ü•à','ü•â','4Ô∏è‚É£'][i]}</div>
      <div style="flex:1">
        <div class="profile-row-label">${c.name}</div>
        <div class="profile-row-val">${c.count} –ª–∏–¥–æ–≤</div>
      </div>
    </div>
  `).join('');

  // Badge –Ω–æ–≤—ã—Ö –ª–∏–¥–æ–≤
  const newLeads = DATA.leads.filter(l => l.hot).length;
  if (newLeads > 0) {
    const badge = document.getElementById('new-badge');
    badge.textContent = newLeads;
    badge.style.display = 'flex';
  }

  // –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—Å–ª–∏ –º–Ω–æ–≥–æ –ª–∏–¥–æ–≤)
  if (DATA.stats.total >= 10) {
    setTimeout(() => {
      document.getElementById('cal-banner').classList.add('show');
    }, 1000);
  }
}

function renderLeads() {
  const list = document.getElementById('leads-list');
  if (DATA.leads.length === 0) {
    list.innerHTML = `
      <div class="empty-state">
        <div class="empty-spider">üï∑</div>
        <div class="empty-title">–ü–∞—É—á–æ–∫ –∏—â–µ—Ç...</div>
        <div class="empty-sub">–ö–∞–∫ —Ç–æ–ª—å–∫–æ –Ω–∞–π–¥—ë—Ç –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ<br>—á–µ–ª–æ–≤–µ–∫–∞ ‚Äî —Å—Ä–∞–∑—É –ø–æ–∫–∞–∂—É</div>
      </div>`;
    return;
  }

  list.innerHTML = DATA.leads.map((lead, i) => `
    <div class="lead-card" style="animation-delay:${i * 0.08}s">
      <div class="lead-card-header">
        <div class="lead-badge ${lead.hot ? 'hot' : 'warm'}">
          ${lead.hot ? 'üî• –ì–æ—Ä—è—á–∏–π' : '‚ö° –¢—ë–ø–ª—ã–π'}
        </div>
        <div class="lead-time">${lead.time}</div>
      </div>
      <div class="lead-user">${lead.user}</div>
      <div class="lead-chat">${lead.chat}</div>
      <div class="lead-text">${lead.text}</div>
      <div class="lead-score-bar">
        <div class="lead-score-fill" style="width:0%" data-score="${lead.score}"></div>
      </div>
      <div class="lead-actions">
        <button class="btn-write" onclick="writeLead(${lead.userId}, '${lead.user}')">
          ‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å
        </button>
        <button class="btn-skip" onclick="skipLead(this, ${lead.id})" title="–°–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
    </div>
  `).join('');

  // –ê–Ω–∏–º–∏—Ä—É–µ–º score-bars
  setTimeout(() => {
    document.querySelectorAll('.lead-score-fill').forEach(bar => {
      bar.style.width = (parseFloat(bar.dataset.score) * 100) + '%';
    });
  }, 400);
}

function renderChart() {
  const days = ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å'];
  const today = new Date().getDay();
  const max = Math.max(...DATA.chart);
  const chart = document.getElementById('bar-chart');

  chart.innerHTML = DATA.chart.map((val, i) => {
    const isToday = i === DATA.chart.length - 1;
    const heightPct = max > 0 ? (val / max * 85) : 0;
    const dayLabel = days[(today - (DATA.chart.length - 1 - i) + 7) % 7];
    return `
      <div class="bar-col">
        <div class="bar${isToday ? ' today' : ''}"
             style="height:0%"
             data-h="${heightPct}%"></div>
        <div class="bar-day">${dayLabel}</div>
      </div>
    `;
  }).join('');

  setTimeout(() => {
    document.querySelectorAll('.bar').forEach(bar => {
      bar.style.height = bar.dataset.h;
    });
  }, 300);
}

// ‚îÄ‚îÄ –ù–∞–≤–∏–≥–∞—Ü–∏—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function switchTab(tab, btn) {
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  switchSection(tab);
}

function switchSection(sec, btn) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.getElementById('sec-' + sec).classList.add('active');

  if (btn) {
    document.querySelectorAll('.bnav-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  }

  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –≤–µ—Ä—Ö–Ω–∏–π nav
  const navBtns = document.querySelectorAll('.nav-btn');
  const tabMap = {leads: 0, profile: 1, analytics: 2};
  if (tabMap[sec] !== undefined) {
    navBtns.forEach(b => b.classList.remove('active'));
    navBtns[tabMap[sec]].classList.add('active');
  }

  if (tg) tg.HapticFeedback?.selectionChanged();
}

// ‚îÄ‚îÄ –î–µ–π—Å—Ç–≤–∏—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function writeLead(userId, username) {
  if (tg) {
    tg.HapticFeedback?.impactOccurred('medium');
    tg.openTelegramLink(`tg://user?id=${userId}`);
  }
  showToast(`–û—Ç–∫—Ä—ã–≤–∞—é —á–∞—Ç —Å ${username}`);
}

function skipLead(btn, id) {
  const card = btn.closest('.lead-card');
  card.style.transition = 'all 0.3s ease';
  card.style.opacity = '0';
  card.style.transform = 'translateX(60px)';
  setTimeout(() => card.remove(), 300);
  if (tg) tg.HapticFeedback?.impactOccurred('light');
}

let isPaused = false;
function togglePause() {
  isPaused = !isPaused;
  const btn = document.getElementById('pause-btn');
  const dot = document.querySelector('.status-dot');
  const pill = document.querySelector('.status-pill');

  if (isPaused) {
    btn.innerHTML = `<div class="ctrl-btn-icon">‚ñ∂Ô∏è</div><div class="ctrl-btn-label">–ó–∞–ø—É—Å—Ç–∏—Ç—å</div><div class="ctrl-btn-sub">–í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫</div>`;
    dot.style.background = '#ff4757';
    dot.style.boxShadow = '0 0 6px #ff4757';
    pill.style.background = 'rgba(255,71,87,0.08)';
    pill.style.borderColor = 'rgba(255,71,87,0.2)';
    pill.querySelector('.status-dot + *') && (pill.lastChild.textContent = 'PAUSE');
    pill.style.color = '#ff4757';
    showToast('‚è∏ –ü–∞—É—á–æ–∫ –Ω–∞ –ø–∞—É–∑–µ');
  } else {
    btn.innerHTML = `<div class="ctrl-btn-icon">‚è∏</div><div class="ctrl-btn-label">–ü–∞—É–∑–∞</div><div class="ctrl-btn-sub">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫</div>`;
    dot.style.background = 'var(--accent)';
    dot.style.boxShadow = '0 0 6px var(--accent)';
    pill.style.background = 'rgba(127,255,110,0.08)';
    pill.style.borderColor = 'rgba(127,255,110,0.2)';
    pill.style.color = 'var(--accent)';
    showToast('‚ñ∂Ô∏è –ü–∞—É—á–æ–∫ —Å–Ω–æ–≤–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç');
  }

  if (tg) {
    tg.HapticFeedback?.impactOccurred('medium');
    tg.sendData(JSON.stringify({ action: isPaused ? 'pause' : 'resume' }));
  }
}

function renewPlan() {
  if (tg) {
    tg.HapticFeedback?.impactOccurred('medium');
    tg.sendData(JSON.stringify({ action: 'renew' }));
  }
  showToast('–û—Ç–∫—Ä—ã–≤–∞—é –æ–ø–ª–∞—Ç—É...');
}

function upgradeAccount() {
  if (tg) {
    tg.HapticFeedback?.impactOccurred('medium');
    tg.sendData(JSON.stringify({ action: 'upgrade' }));
  }
  showToast('üöÄ –û—Ç–∫—Ä—ã–≤–∞—é –ü—Ä–æ —Ç–∞—Ä–∏—Ñ...');
}

function openSupport() {
  if (tg) {
    tg.HapticFeedback?.selectionChanged();
    tg.sendData(JSON.stringify({ action: 'support' }));
  }
  showToast('üí¨ –û—Ç–∫—Ä—ã–≤–∞—é –ø–æ–¥–¥–µ—Ä–∂–∫—É...');
}

function calibrate(rating) {
  document.getElementById('cal-banner').classList.remove('show');
  if (tg) {
    tg.HapticFeedback?.notificationOccurred(rating === 'good' ? 'success' : 'warning');
    tg.sendData(JSON.stringify({ action: 'calibrate', rating }));
  }
  if (rating === 'good') {
    showToast('üëç –ü—Ä–æ–¥–æ–ª–∂–∞—é –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!');
  } else {
    showToast('üéØ –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é –ø–æ–¥ —Ç–µ–±—è...');
  }
}

// ‚îÄ‚îÄ –£—Ç–∏–ª–∏—Ç—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function animateNumber(id, target) {
  const el = document.getElementById(id);
  let start = 0;
  const step = Math.ceil(target / 30);
  const interval = setInterval(() => {
    start = Math.min(start + step, target);
    el.textContent = start;
    if (start >= target) clearInterval(interval);
  }, 40);
}

let toastTimer;
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 2500);
}

// ‚îÄ‚îÄ –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç –±–æ—Ç–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: fetch('/api/data?user_id=...') –∏–ª–∏ tg.initDataUnsafe
// –ü–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º mock –∏ –∏–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É
setTimeout(() => loadData(), 400);

// –ü–µ—Ä–µ–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
if (tg) {
  tg.onEvent('viewportChanged', () => {
    if (!tg.isExpanded) tg.expand();
  });
}
</script>
</body>
</html>
